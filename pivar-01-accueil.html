<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIVAR - Accueil S√©curis√©</title>
    <style>
        /* PROTECTION CSS ABSOLUE - FONCTIONNE PARTOUT */
        * {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
            -webkit-touch-callout: none !important;
            -khtml-user-select: none !important;
            -webkit-user-drag: none !important;
            -khtml-user-drag: none !important;
            -moz-user-drag: none !important;
            -o-user-drag: none !important;
            user-drag: none !important;
        }

        *::selection { background: transparent !important; }
        *::-moz-selection { background: transparent !important; }
        *::-webkit-selection { background: transparent !important; }

        html, body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* EMP√äCHER TOUTE S√âLECTION */
        body {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
            -webkit-touch-callout: none !important;
        }

        .header-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-banner h1 {
            font-size: 20px;
            margin: 0;
        }

        .progress-bar {
            background: #28a745;
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: calc(100vh - 100px);
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
        }

        .security-notice {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 0;
            font-size: 13px;
            color: #856404;
            text-align: center;
            font-weight: 500;
        }

        .questionnaire-frame {
            width: 100%;
            height: calc(100vh - 160px);
            border: none;
            display: block;
        }

        .footer {
            background: #f8f9fa;
            text-align: center;
            padding: 10px;
            font-size: 12px;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }

        /* TRACKING VISIBLE */
        .security-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            z-index: 10000;
            border: 2px solid #fff;
            box-shadow: 0 2px 10px rgba(220, 53, 69, 0.3);
        }

        .violation-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #dc3545;
            color: white;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #fff;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            z-index: 999999;
            display: none;
            text-align: center;
            max-width: 500px;
            animation: shake 0.5s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translate(-50%, -50%) translateX(0); }
            25% { transform: translate(-50%, -50%) translateX(-10px); }
            75% { transform: translate(-50%, -50%) translateX(10px); }
        }

        .popup-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .popup-message {
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .popup-countdown {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffeb3b;
        }

        /* WATERMARKS MULTIPLES */
        .watermark1 {
            position: fixed;
            top: 25%;
            left: 20%;
            transform: rotate(-45deg);
            font-size: 1rem;
            color: rgba(220, 53, 69, 0.1);
            z-index: 1;
            pointer-events: none;
            font-weight: bold;
        }

        .watermark2 {
            position: fixed;
            bottom: 25%;
            right: 20%;
            transform: rotate(45deg);
            font-size: 1rem;
            color: rgba(220, 53, 69, 0.1);
            z-index: 1;
            pointer-events: none;
            font-weight: bold;
        }

        .session-info {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: rgba(108, 117, 125, 0.6);
            text-align: center;
            pointer-events: none;
        }

        /* MOBILE */
        @media (max-width: 768px) {
            .header-banner h1 { font-size: 16px; }
            .progress-bar { font-size: 12px; padding: 6px; }
            .questionnaire-frame { height: calc(100vh - 140px); }
            .violation-popup { margin: 20px; max-width: none; }
        }

        /* PROTECTION PRINT */
        @media print {
            * { display: none !important; }
            body::before {
                content: "DOCUMENT PROT√âG√â - IMPRESSION INTERDITE - SESSION PIVAR";
                display: block !important;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 2rem;
                color: red;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Status de s√©curit√© visible -->
    <div class="security-status" id="securityStatus">
        üõ°Ô∏è S√©curis√© ‚Ä¢ Violations: <span id="violationCounter">0</span>
    </div>

    <!-- Watermarks -->
    <div class="watermark1">SESSION PIVAR PROT√âG√âE</div>
    <div class="watermark2">REPRODUCTION INTERDITE</div>
    
    <!-- Info session -->
    <div class="session-info" id="sessionInfo">
        Session: <span id="sessionId"></span> ‚Ä¢ IP: <span id="userIp">R√©cup√©ration...</span>
    </div>

    <!-- En-t√™te PIVAR -->
    <div class="header-banner">
        <h1>üß† PIVAR ‚Äì Protocole d'identification et de valorisation de l'action et de la r√©ussite</h1>
        <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;">Plateforme s√©curis√©e d'√©valuation comportementale</p>
    </div>

    <!-- Barre de progression -->
    <div class="progress-bar">
        üìä QUESTIONNAIRE 1/7 : ACCUEIL PIVAR ‚Ä¢ Session s√©curis√©e ‚Ä¢ Toute reproduction est interdite
    </div>

    <!-- Conteneur principal -->
    <div class="main-container">
        <!-- Notice de s√©curit√© -->
        <div class="security-notice">
            ‚ö†Ô∏è √âVALUATION SOUS SURVEILLANCE ‚Ä¢ Votre activit√© est enregistr√©e ‚Ä¢ Maximum 3 violations autoris√©es
        </div>

        <!-- Questionnaire Tally -->
        <iframe 
            class="questionnaire-frame" 
            src="https://formulaires.pivar.info/r/mJog7Y"
            title="Questionnaire PIVAR S√©curis√©"
            allowtransparency="true"
            sandbox="allow-scripts allow-forms allow-same-origin allow-popups"
            referrerpolicy="no-referrer-when-downgrade">
        </iframe>

        <!-- Pied de page -->
        <div class="footer">
            PIVAR ¬© 2025 ‚Ä¢ Contenu prot√©g√© ‚Ä¢ Violations signal√©es aux autorit√©s comp√©tentes
        </div>
    </div>

    <!-- POPUP DE VIOLATION -->
    <div id="violationPopup" class="violation-popup">
        <div class="popup-title" id="popupTitle">üö® VIOLATION D√âTECT√âE</div>
        <div class="popup-message" id="popupMessage">Action non autoris√©e</div>
        <div class="popup-countdown">Fermeture dans <span id="popupCountdown">5</span>s</div>
    </div>

    <script>
        // VARIABLES GLOBALES
        let VIOLATIONS = 0;
        const MAX_VIOLATIONS = 3;
        const SESSION_ID = 'PIVAR_' + Date.now().toString(36).toUpperCase();
        let USER_IP = 'R√©cup√©ration...';
        let POPUP_ACTIVE = false;

        // INITIALISATION
        document.getElementById('sessionId').textContent = SESSION_ID.substring(6, 12);
        
        // R√©cup√©ration IP
        fetch('https://api.ipify.org?format=json')
            .then(r => r.json())
            .then(data => {
                USER_IP = data.ip;
                document.getElementById('userIp').textContent = USER_IP;
            })
            .catch(() => {
                USER_IP = 'IP_MASQU√âE';
                document.getElementById('userIp').textContent = USER_IP;
            });

        console.log('üõ°Ô∏è PIVAR SIMPLE - Session:', SESSION_ID);

        // FONCTION DE VIOLATION
        function showViolation(type, details) {
            if (POPUP_ACTIVE) return; // √âviter le spam
            
            VIOLATIONS++;
            document.getElementById('violationCounter').textContent = VIOLATIONS;
            
            console.log(`üö® VIOLATION ${VIOLATIONS}: ${type} - ${details}`);
            
            const popup = document.getElementById('violationPopup');
            const title = document.getElementById('popupTitle');
            const message = document.getElementById('popupMessage');
            
            if (VIOLATIONS >= MAX_VIOLATIONS) {
                title.textContent = 'üö´ SESSION TERMIN√âE';
                message.innerHTML = `
                    <strong>EXCLUSION AUTOMATIQUE</strong><br><br>
                    ${VIOLATIONS} violations d√©tect√©es.<br>
                    Un rapport a √©t√© envoy√© √† notre √©quipe.<br><br>
                    <strong>Session:</strong> ${SESSION_ID}<br>
                    <strong>IP:</strong> ${USER_IP}
                `;
                
                setTimeout(() => {
                    alert('Session termin√©e pour violations r√©p√©t√©es.\nVous serez contact√© par notre √©quipe.');
                    window.location.href = 'about:blank';
                }, 5000);
                
            } else {
                title.textContent = `üö® VIOLATION ${VIOLATIONS}/${MAX_VIOLATIONS}`;
                message.innerHTML = `
                    <strong>${type}</strong><br>
                    ${details}<br><br>
                    ${MAX_VIOLATIONS - VIOLATIONS} violation(s) restante(s)<br>
                    Session enregistr√©e: ${SESSION_ID}
                `;
            }
            
            popup.style.display = 'block';
            POPUP_ACTIVE = true;
            
            // Countdown et fermeture
            let countdown = 5;
            const countdownEl = document.getElementById('popupCountdown');
            const interval = setInterval(() => {
                countdown--;
                countdownEl.textContent = countdown;
                if (countdown <= 0) {
                    clearInterval(interval);
                    popup.style.display = 'none';
                    POPUP_ACTIVE = false;
                }
            }, 1000);
        }

        // PROTECTION MULTIPLE SIMPLE
        
        // 1. Clic droit - M√âTHODE MULTIPLE
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            showViolation('CLIC DROIT INTERDIT', 'Menu contextuel d√©sactiv√©');
            return false;
        });
        
        document.oncontextmenu = function() {
            showViolation('CLIC DROIT INTERDIT', 'Tentative menu contextuel');
            return false;
        };
        
        window.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });

        // 2. S√©lection de texte - M√âTHODE MULTIPLE
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
            showViolation('S√âLECTION INTERDITE', 'Tentative de s√©lection de texte');
            return false;
        });
        
        document.onselectstart = function() {
            showViolation('S√âLECTION INTERDITE', 'S√©lection bloqu√©e');
            return false;
        };

        // 3. Clavier - TOUTES LES COMBINAISONS
        document.addEventListener('keydown', function(e) {
            let violation = null;
            
            // Print Screen
            if (e.key === 'PrintScreen' || e.keyCode === 44 || e.keyCode === 42) {
                violation = 'CAPTURE √âCRAN INTERDITE';
            }
            // Ctrl + quelque chose
            else if (e.ctrlKey) {
                violation = `CTRL+${e.key || 'TOUCHE'} INTERDIT`;
            }
            // Alt + quelque chose  
            else if (e.altKey && e.key !== 'Tab') {
                violation = `ALT+${e.key || 'TOUCHE'} INTERDIT`;
            }
            // Touches F
            else if (e.key && e.key.startsWith('F') && e.key !== 'F5') {
                violation = `TOUCHE ${e.key} INTERDITE`;
            }
            // Windows/Cmd
            else if (e.metaKey) {
                violation = `WIN+${e.key || 'TOUCHE'} INTERDIT`;
            }
            
            if (violation) {
                e.preventDefault();
                e.stopPropagation();
                showViolation(violation, 'Combinaison de touches bloqu√©e');
                return false;
            }
        });

        // 4. Glisser-d√©poser
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            showViolation('GLISSER-D√âPOSER INTERDIT', 'Action bloqu√©e');
            return false;
        });

        // 5. Double-clic (s√©lection rapide)
        document.addEventListener('dblclick', function(e) {
            e.preventDefault();
            showViolation('DOUBLE-CLIC INTERDIT', 'S√©lection rapide bloqu√©e');
            return false;
        });

        // 6. DevTools
        setInterval(function() {
            if (window.outerWidth - window.innerWidth > 100 || 
                window.outerHeight - window.innerHeight > 100) {
                showViolation('OUTILS D√âVELOPPEUR', 'F12 d√©tect√©');
            }
        }, 2000);

        // 7. Mobile - gestes
        if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length >= 3) {
                    e.preventDefault();
                    showViolation('GESTE MOBILE INTERDIT', 'Capture d\'√©cran suspect√©e');
                }
            });
        }

        // PROTECTION CONTRE MODIFICATION CONSOLE
        console.log('%cüö® PIVAR S√âCURIS√â', 'color: red; font-size: 20px; font-weight: bold;');
        console.log('%cToute violation est enregistr√©e', 'color: orange; font-size: 14px;');
        console.log('Session ID:', SESSION_ID);
        
        // CLEANUP
        window.addEventListener('beforeunload', function() {
            if (VIOLATIONS > 0) {
                console.log(`üìä Session termin√©e - ${VIOLATIONS} violations d√©tect√©es`);
            }
        });
    </script>
</body>
</html>
