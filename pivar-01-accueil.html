<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIVAR - Accueil S√©curis√©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            /* Protection s√©lection sur l'interface uniquement */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Permettre la s√©lection dans l'iframe */
        iframe {
            -webkit-user-select: auto !important;
            -moz-user-select: auto !important;
            -ms-user-select: auto !important;
            user-select: auto !important;
        }

        .header-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-banner h1 {
            font-size: 20px;
            margin: 0;
        }

        .progress-bar {
            background: #28a745;
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: calc(100vh - 100px);
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .security-notice {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 0;
            font-size: 13px;
            color: #155724;
            text-align: center;
        }

        .questionnaire-frame {
            width: 100%;
            height: calc(100vh - 160px);
            border: none;
            display: block;
        }

        .footer {
            background: #f8f9fa;
            text-align: center;
            padding: 10px;
            font-size: 12px;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }

        /* NOTIFICATION DISCR√àTE (pas d'overlay qui bloque) */
        .security-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(220, 53, 69, 0.4);
            z-index: 10000;
            display: none;
            max-width: 350px;
            border-left: 5px solid #fff;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .notification-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }

        .notification-message {
            font-size: 12px;
            line-height: 1.3;
            margin-bottom: 8px;
        }

        .notification-countdown {
            font-size: 11px;
            opacity: 0.8;
            text-align: right;
        }

        /* Watermark discret */
        .watermark {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: rgba(108, 117, 125, 0.3);
            pointer-events: none;
            z-index: 1;
        }

        /* Styles mobiles */
        @media (max-width: 768px) {
            .header-banner h1 {
                font-size: 16px;
            }
            .progress-bar {
                font-size: 12px;
                padding: 6px;
            }
            .questionnaire-frame {
                height: calc(100vh - 140px);
            }
            .security-notification {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }

        /* Indicateur de session s√©curis√©e */
        .security-indicator {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(40, 167, 69, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 10px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .security-dot {
            width: 6px;
            height: 6px;
            background: #fff;
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <!-- Indicateur de session s√©curis√©e -->
    <div class="security-indicator">
        <div class="security-dot"></div>
        Session s√©curis√©e
    </div>

    <!-- Watermark discret -->
    <div class="watermark">
        PIVAR - √âvaluation Prot√©g√©e ¬© 2025
    </div>

    <!-- En-t√™te professionnel PIVAR -->
    <div class="header-banner">
        <h1>üß† PIVAR ‚Äì Protocole d'identification et de valorisation de l'action et de la r√©ussite</h1>
        <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;">Plateforme s√©curis√©e d'√©valuation comportementale</p>
    </div>

    <!-- Barre de progression -->
    <div class="progress-bar">
        üìä QUESTIONNAIRE 1/7 : ACCUEIL PIVAR ‚Ä¢ Session s√©curis√©e ‚Ä¢ Reproduction interdite - Protection CONTINEW
    </div>

    <!-- Conteneur principal -->
    <div class="main-container">
        <!-- Notice de s√©curit√© -->
        <div class="security-notice">
            ‚úÖ Session s√©curis√©e active ‚Ä¢ Vos donn√©es sont prot√©g√©es ‚Ä¢ √âvaluation confidentielle
        </div>

        <!-- Questionnaire Tally int√©gr√© -->
        <iframe 
            class="questionnaire-frame" 
            src="https://formulaires.pivar.info/r/mJog7Y"
            title="Questionnaire PIVAR S√©curis√©"
            allowtransparency="true"
            sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
            referrerpolicy="no-referrer-when-downgrade">
        </iframe>

        <!-- Pied de page -->
        <div class="footer">
            PIVAR ¬© 2025 ‚Ä¢ Toute reproduction interdite
        </div>
    </div>

    <!-- NOTIFICATION DISCR√àTE (ne bloque pas l'√©cran) -->
    <div id="securityNotification" class="security-notification">
        <div class="notification-title">
            üõ°Ô∏è <span id="notificationTitle">S√©curit√© PIVAR</span>
        </div>
        <div class="notification-message" id="notificationMessage">
            Action d√©tect√©e
        </div>
        <div class="notification-countdown">
            <span id="notificationCountdown"></span>
        </div>
    </div>

    <script>
        // Configuration intelligente
        const SMART_SECURITY = {
            sessionId: 'PIVAR_SMART_' + Date.now(),
            violations: 0,
            lastAlert: 0,
            alertCooldown: 2000, // 2 secondes entre alertes
            enabled: true
        };

        console.log('üõ°Ô∏è PIVAR Smart Security - Session:', SMART_SECURITY.sessionId);

        // Notification discr√®te (ne bloque pas l'utilisateur)
        function showSmartNotification(title, message, duration = 4000) {
            const now = Date.now();
            
            // √âviter le spam de notifications
            if (now - SMART_SECURITY.lastAlert < SMART_SECURITY.alertCooldown) {
                return;
            }
            
            SMART_SECURITY.lastAlert = now;
            SMART_SECURITY.violations++;
            
            const notification = document.getElementById('securityNotification');
            const titleElement = document.getElementById('notificationTitle');
            const messageElement = document.getElementById('notificationMessage');
            const countdownElement = document.getElementById('notificationCountdown');
            
            titleElement.textContent = title;
            messageElement.innerHTML = `${message}<br><small>Violation #${SMART_SECURITY.violations} - Session surveill√©e</small>`;
            
            notification.style.display = 'block';
            
            // Countdown discret
            let timeLeft = Math.ceil(duration / 1000);
            countdownElement.textContent = `Fermeture dans ${timeLeft}s`;
            
            const countdownInterval = setInterval(() => {
                timeLeft--;
                countdownElement.textContent = `Fermeture dans ${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
            
            // Masquer automatiquement
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = 'slideIn 0.3s ease-out';
                }, 300);
            }, duration);
            
            console.log(`üìä Security Event: ${title} - ${message}`);
        }

        // PROTECTION CLIC DROIT (sur l'interface uniquement)
        document.addEventListener('contextmenu', function(e) {
            // Ne pas bloquer dans l'iframe (permettre le questionnaire)
            if (e.target.closest('iframe')) {
                return true;
            }
            
            e.preventDefault();
            showSmartNotification('Clic droit d√©tect√©', 'Menu contextuel d√©sactiv√© sur l\'interface PIVAR');
            return false;
        });

        // PROTECTION CLAVIER INTELLIGENTE
        document.addEventListener('keydown', function(e) {
            let shouldBlock = false;
            let alertTitle = '';
            let alertMessage = '';
            
            // Print Screen - toutes variantes
            if (e.key === 'PrintScreen' || e.code === 'PrintScreen' || 
                e.keyCode === 44 || e.keyCode === 42 || e.keyCode === 124) {
                shouldBlock = true;
                alertTitle = 'Capture d\'√©cran d√©tect√©e';
                alertMessage = 'Print Screen d√©sactiv√© pour prot√©ger le contenu';
            }
            // F12 et outils d√©veloppeur
            else if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key))) {
                shouldBlock = true;
                alertTitle = 'Outils d√©veloppeur';
                alertMessage = 'Acc√®s aux outils de d√©veloppement restreint';
            }
            // Ctrl+U (voir source)
            else if (e.ctrlKey && e.key === 'u') {
                shouldBlock = true;
                alertTitle = 'Code source';
                alertMessage = 'Affichage du code source d√©sactiv√©';
            }
            // Ctrl+S (sauvegarder)
            else if (e.ctrlKey && e.key === 's') {
                shouldBlock = true;
                alertTitle = 'Sauvegarde d√©tect√©e';
                alertMessage = 'Sauvegarde de la page d√©sactiv√©e';
            }
            // Ctrl+P (imprimer)
            else if (e.ctrlKey && e.key === 'p') {
                shouldBlock = true;
                alertTitle = 'Impression d√©tect√©e';
                alertMessage = 'Impression de la page d√©sactiv√©e';
            }
            
            if (shouldBlock) {
                e.preventDefault();
                e.stopPropagation();
                showSmartNotification(alertTitle, alertMessage);
                return false;
            }
        });

        // PROTECTION S√âLECTION (interface uniquement)
        document.addEventListener('selectstart', function(e) {
            // Permettre la s√©lection dans l'iframe
            if (e.target.closest('iframe')) {
                return true;
            }
            
            // Bloquer sur l'interface PIVAR
            if (e.target.closest('.header-banner, .progress-bar, .security-notice, .footer')) {
                e.preventDefault();
                showSmartNotification('S√©lection restreinte', 'S√©lection d√©sactiv√©e sur l\'interface de navigation');
                return false;
            }
        });

        // D√âTECTION DEVTOOLS PASSIVE
        let devToolsWarningShown = false;
        function checkDevTools() {
            const threshold = 200;
            const heightDiff = window.outerHeight - window.innerHeight;
            const widthDiff = window.outerWidth - window.innerWidth;
            
            if ((heightDiff > threshold || widthDiff > threshold) && !devToolsWarningShown) {
                devToolsWarningShown = true;
                showSmartNotification('Outils d√©veloppeur d√©tect√©s', 'Session surveill√©e - Utilisation normale recommand√©e', 6000);
                
                // Reset du warning apr√®s 30 secondes
                setTimeout(() => {
                    devToolsWarningShown = false;
                }, 30000);
            }
        }

        // PROTECTION MOBILE
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            console.log('üì± Mode mobile d√©tect√©');
            
            // Gestes de capture sur mobile
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length >= 3) {
                    showSmartNotification('Geste mobile d√©tect√©', 'Capture d\'√©cran mobile suspect√©e');
                }
            });
        }

        // INITIALISATION
        window.addEventListener('load', function() {
            console.log('‚úÖ PIVAR Smart Security initialis√©');
            
            // V√©rification DevTools moins agressive
            setInterval(checkDevTools, 3000);
            
            // Message de bienvenue
            setTimeout(() => {
                if (!sessionStorage.getItem('pivar-smart-welcome')) {
                    showSmartNotification('Bienvenue sur PIVAR', 'Plateforme s√©curis√©e - √âvaluation en cours de protection', 5000);
                    sessionStorage.setItem('pivar-smart-welcome', 'shown');
                }
            }, 2000);
        });

        // LOG DE FERMETURE
        window.addEventListener('beforeunload', function() {
            console.log(`üìä Session PIVAR termin√©e - ${SMART_SECURITY.violations} violations d√©tect√©es`);
        });

        // Message d√©veloppeur discret
        console.log('%cüõ°Ô∏è PIVAR Smart Security', 'color: #28a745; font-size: 14px; font-weight: bold;');
        console.log('%cSyst√®me de protection intelligent - Utilisation normale autoris√©e', 'color: #6c757d; font-size: 12px;');
    </script>
</body>
</html>
